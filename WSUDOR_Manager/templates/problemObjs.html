{% include 'header.html' %}
<script>
$(document).ready(function () {

    // add to workspace and remove object button actions
    $(function(APP_HOST)
    {
        $(document).on('click', '.btn', function(e)
        {
            e.preventDefault();
            button = this.id;
            var pid = $(this).closest("div").attr("id");
            if (button == "removeButton") {
                var action="removeObj";
            }
            if (button == "addButton") {
                var action="claimObj";
            }
            $.ajax({
                url: "/{{APP_PREFIX}}/"+action,
                type: "POST",
                data:{"pid":"wayne:"+pid}
            }).done(function(response) { $("#"+pid).fadeToggle("slow", "linear"); location.reload(); });

            });

         return false;
     });
    });
</script>

<div class="row">
<div class="col-md-12 col-md-offset-5 panel"><h3>User-Reported Problem Objects</h3></div>
</div>
<script>

</script>
<div class="row">
{% set counter = 0 -%}
{% set pid = '' %}
{%for obj in problemObjs %}

{% with prefix, pid = obj.PID.split(':') %}

<div id="{{pid}}-{{counter + loop.index0}}" class="col-md-3 col-md-offset-1 panel">

    <table class="table table-striped table-bordered table-hover table-condensed">
    	<!-- Image -->
    	<tr><span class="problemImg" style="float:left; margin-right: 7px;">

    		<a target="_blank" href="//{{APP_HOST}}/digitalcollections/item?id={{obj.PID}}"><img class="img-rounded" style="height:10%;" src="//{{APP_HOST}}/fedora/objects/{{obj.PID}}/datastreams/THUMBNAIL/content"/></a>

		<!-- Buttons -->
            <button id="removeButton" class="btn btn-success btn-danger" type="button">
                <span class="glyphicon glyphicon-minus"></span>
            </button>


            <button id="addButton" class="btn btn-success btn-add" type="button">
                <span class="glyphicon glyphicon-plus"></span>
            </button>

    	</span></tr>
    	<!-- Metadata -->

    	<tr>
    		<td><b>PID:</b> {{obj.PID}}</td>
    	</tr>
    	<tr>
    		<td><b>Title:</b> {{obj.solr_package['dc_title']}}</td>
    	</tr>


        <!-- Notes -->
		<tr>
			<td><b>Notes:</b> 
		{% if obj.notes is not none %}
			name: {{obj.notes['name']}}
			email: {{obj.notes['email']}}
			message: {{obj.notes['message']}}
		{% else %}
			NONE
		{% endif %}
			</td>
		</tr>
</table>
	<!-- </div> -->
</div>
{% endwith %}
{% set counter = counter + group|length %}
{% endfor %}
</div>
{% include 'footer.html' %}
